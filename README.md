# predator
Predator IDS and Proxy solution

## Main concepts
* NIDS = Network Intrusion Detection System, it is a tool used to identify a threat inside a network basing on a set of rules user-defined
* Proxy = It is a tool used to provide a single Internet access point with SSL termination in order to check encrypted traffic

## Overview
Predator has been designed to reach following needs:
* Easy rules integration
* Modularity
* Multithreaded, usable and fast
* Syslog log redirection to be analyzed by third parties (SIEM)

## Rules integration
As default, Predator is able to ingest rules generated by my [Anubi Signatures project](https://github.com/kavat/anubi-signatures)
It allows rules based on:
* IP (file with suffix _ip.json)
* TOR nodes (tor_nodes.list)
* domain (file with suffix _fqdn.json)
* payload (patterns_tcp_udp.json)
Format is similar for IP and domains, such below:
* Simple file JSON with IP as key and description CTI as value, such
```
{"1.10.146.175":"misp","1.117.62.81":"misp","1.14.194.206":"misp","1.14.206.72":"misp", … }
```
name will be similar to anubi_YYYY_MM_ip.json
* Simple file JSON with domain as key and description CTI as value, such
name will be similar to anubi_YYYY_MM_fqdn.json
```
{"0-lx.2037673.xyz":"misp","0-lx.49746487.xyz":"misp","00lx.13265926.xyz":“misp", …}
```
* Simple file with Array with patterns as values, such
```
["PATTERN_1", "PATTERN_2", "PATTERN_3", …] 
```
name is static and it is patterns_tcp_udp.json

## Modules
### Layer 4 source/destination control
Based on set of rules previously described
Check for incoming/outcoming connection from/to malicious IP
### Layer 7 pattern match
Based on set of rules previously described
Check for incoming/outcoming connection with pattern monitored
### Proxy
MITM for SSL termination and possibility to pattern checking based on rules previously described
### Dummy
Traffic decryption through Proxy module and replication to internal network for third parties analysis (such Suricata)

## Custom tags
* On HTTP connection, Host field in header is isolated if available and propagated in log visibility in order to whitelist if host is safe
* On HTTPS connection with no SSL termination, SNI field in TLS extensions is isolated if available and propagated in log visibility in order to whitelist if host is safe
